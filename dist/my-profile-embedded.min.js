!function(e){function n(a){if(o[a])return o[a].exports;var t=o[a]={exports:{},id:a,loaded:!1};return e[a].call(t.exports,t,t.exports,n),t.loaded=!0,t.exports}var o={};return n.m=e,n.c=o,n.p="/",n(0)}([function(e,n,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}var t=o(3),r=a(t);angular.module("gumga.myAccountEmbedded",[]).component("myAccountEmbedded",r.default)},function(e,n){"use strict";function o(e,n,o){e.myCroppedImage="",e.myImage=n,e.crop=function(e){var n=e.substring(e.indexOf(":")+1,e.indexOf(";")),a={mimeType:n,name:"profilePicture."+n.substring(n.lastIndexOf("/")+1,n.length),bytes:e.substring(e.indexOf(",")+1,e.length),size:Math.round(6*e.length/8)};o.close(a)},e.close=function(){o.close()}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=o,o.$inject=["$scope","image","$uibModalInstance"]},function(e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default='\n    <div class="modal-header modal-header-my-profile">\n      <i class="glyphicon glyphicon-remove close-crop-my-profile" ng-click="close()"></i>\n      <span>Arraste a imagem para ajustar</span>\n    </div>\n    <div class="modal-body modal-body-my-profile">\n      <div class="cropArea">\n        <img-crop image="myImage" result-image="myCroppedImage"></img-crop>\n      </div>\n    </div>\n    <div class="modal-footer modal-footer-my-profile">\n      <button class="btn btn-done-my-profile"\n              type="button"\n              ng-click="crop(myCroppedImage)">\n              <i class="glyphicon glyphicon-ok"></i>\n              </button>\n    </div>\n  '},function(e,n,o){"use strict";function a(e){return e&&e.__esModule?e:{default:e}}function t(e,n,o,a){var t,r=this,s=JSON.parse(sessionStorage.getItem("user"));r.user=angular.copy(s);var i=function(){return r.configuration.defaultPicture||"resources/images/user-not-image.png"},d=function(n,o){e(function(){r.user.pictureURL="data:"+n.mimeType+";base64,"+n.bytes}),o||u()},u=function(){s.picture=r.user.picture,sessionStorage.setItem("user",JSON.stringify(s)),a.$broadcast("updateUserPicture",s),r.saveUser()};r.saveUser=function(e){o.put(r.configuration.appURL+"/api/security/update-user",{name:r.user.name,picture:r.user.picture,login:r.user.login},{headers:{gumgaToken:r.user.token}}).then(function(n){200==n.status&&e&&swal("Perfil atualizado",e,"success")},function(){swal("Aconteceu um erro na tentativa de salvar suas atualizações, tente novamente.")})},e(function(){t=document.getElementById("my-account-file-input"),t||location.reload(),t.onchange=function(e){var n=e.srcElement||e.target;if(0!=n.files.length){var o=n.files[0];if(o){var a=new FileReader;a.readAsDataURL(o),a.onload=function(e){var n=e.target.result;r.openModalCropImage(n)}}}},r.user.picture?d(r.user.picture,!0):r.user.pictureURL=i()},1e3),r.capturePicture=function(){var e=n.open({template:c.default,controller:p.default,controllerAs:"$ctrl",backdrop:"static",size:"md",resolve:{}});e.result.then(function(e){e&&r.openModalCropImage(e)})},r.loadPicture=function(){t.click()},r.removePicture=function(){r.user.pictureURL=i(),r.user.picture=null,u()},r.openModalCropImage=function(e){var o=n.open({template:l.default,controller:f.default,controllerAs:"$ctrl",backdrop:"static",size:"md",resolve:{image:function(){return e}}});o.result.then(function(e){e&&(r.user.picture=e,d(r.user.picture))})},r.updatePassword=function(e,n,a){return e?!n||n.length<=2?void swal("Informe uma nova senha que tenha ao menos 3 digitos."):n==e?(swal("Por favor, escolha uma senha diferente da antiga."),delete r.user.newPassword,void delete r.user.confirmNewPassword):a&&a==n?void o.put(r.configuration.appURL+"/public/token",{user:r.user.login,password:e,newPassword:n}).then(function(e){"BAD_PASSWORD"==e.data.response&&(swal("A senha antiga está incorreta."),delete r.user.oldPassword),"OK"==e.data.response&&(swal("Atualizado","Sua senha foi atualizada com sucesso.","success"),delete r.user.oldPassword,delete r.user.newPassword,delete r.user.confirmNewPassword)}):(swal("Você deve repetir sua senha corretamente."),void delete r.user.confirmNewPassword):void swal("Informe sua senha atual.")}}Object.defineProperty(n,"__esModule",{value:!0});var r=o(6),s=a(r),i=o(2),l=a(i),d=o(5),c=a(d),u=o(4),p=a(u),m=o(1),f=a(m);t.$inject=["$timeout","$uibModal","$http","$rootScope"],n.default={bindings:{configuration:"<?"},template:s.default,controller:t}},function(e,n){"use strict";function o(e,n,o){var a,t,r;navigator.getUserMedia({video:!0},function(e){o(function(){r=e,a=document.getElementById("video-area-my-profile"),t=document.getElementById("canvas-area-my-profile"),a.srcObject=e,a.play()},500)},function(n){"PermissionDeniedError"==n.name?(swal("Você precisa permitir o acesso a sua Câmera."),e.close()):"DevicesNotFoundError"==n.name?(swal("Conecte uma câmera para tirar fotos."),e.close()):(swal("Aconteceu um erro na tentativa ligar a câmera."),e.close())}),e.take=function(){t.width=a.clientWidth,t.height=a.clientHeight,t.getContext("2d").drawImage(a,0,0,t.width,t.height);var n=t.toDataURL("image/png");e.close(n)},e.close=function(e){r&&(r.stop&&r.stop(),r.stopUserMedia&&r.stopUserMedia(),r.getVideoTracks().forEach(function(e){e.stop()})),n.close(e)}}Object.defineProperty(n,"__esModule",{value:!0}),n.default=o,o.$inject=["$scope","$uibModalInstance","$timeout"]},function(e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default='\n\n    <div class="modal-header modal-header-my-profile">\n      <i class="glyphicon glyphicon-remove close-crop-my-profile" ng-click="close()"></i>\n      <span>Tirar foto</span>\n    </div>\n    <div class="modal-body modal-body-my-profile" style="margin-bottom: -5px;height: 449px;">\n      <video id="video-area-my-profile" width="100%" height="100%"></video>\n      <canvas id="canvas-area-my-profile" style="display:none;"></canvas>\n    </div>\n    <div class="modal-footer modal-footer-my-profile">\n      <button class="btn btn-take-my-profile"\n              type="button"\n              ng-click="take()">\n              <i class="glyphicon glyphicon-camera"></i>\n              </button>\n    </div>\n    '},function(e,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default='\n<style>\n  my-account-embedded .form-control.gmd[disabled]{\n    background: #E4E4E4;\n  }\n  .cropArea {\n    background: #E4E4E4;\n    overflow: hidden;\n    width:100%;\n    height:350px;\n  }\n  .modal-body-my-profile{\n    padding: 0;\n  }\n  .modal-footer-my-profile{\n    background-color: #e0e0e0 !important;\n    padding: 0;\n    border: 0;\n    height: 100px;\n  }\n  .modal-header-my-profile{\n    background: #1eb7ad;\n    border: none;\n    color: #fff;\n  }\n  .modal-header-my-profile > span{\n    font-weight: 500;\n    font-size: 19px;\n    line-height: 19px;\n  }\n  .btn-done-my-profile{\n    width: 60px;\n    color: #fff !important;\n    height: 60px;\n    border-radius: 50%;\n    position: absolute;\n    outline: none !important;\n    right: 25px;\n    top: 365px;\n    font-size: 25px;\n    background: #1eb7ad;\n    padding-top: 10px;\n  }\n  .btn-take-my-profile{\n    width: 60px;\n    padding-top: 10px;\n    color: #fff !important;\n    height: 60px;\n    border-radius: 50%;\n    position: absolute;\n    outline: none !important;\n    font-size: 25px;\n    right: 25px;\n    top: 465px;\n    background: #1eb7ad;\n  }\n  .close-crop-my-profile{\n    cursor: pointer;\n  }\n</style>\n<div class="row">\n  <div class="col-xs-12">\n\n    <div class="row">\n      <div class="col-lg-2 col-sm-2 col-xs-12">\n          <div class="gmd panel panel-default">\n            <div class="panel-body">\n              <img ng-src="{{$ctrl.user.pictureURL}}" class="img-responsive img-circle"/>\n              <input id="my-account-file-input" type="file" style="display: none;" accept=".png, .jpg, .jpeg"/>\n              <div class="dropdown gmd" align="center" style="margin-top: 15px;">\n                  <button class="link gmd btn" aria-expanded="false"\n                       data-toggle="dropdown"\n                       aria-haspopup="true"\n                       aria-hidden="true">\n                      <i class="glyphicon glyphicon-pencil"></i>\n                      Alterar foto\n                  </button>\n                  <ul class="dropdown-menu gmd" aria-labelledby="dropdownMenu">\n                      <li ><a style="padding: 15px;cursor: pointer;" ng-click="$ctrl.capturePicture()">Tirar foto</a></li>\n                      <li ><a style="padding: 15px;cursor: pointer;" ng-click="$ctrl.loadPicture()">Carregar foto</a></li>\n                      <li ><a style="padding: 15px;cursor: pointer;" ng-click="$ctrl.removePicture()">Remover foto</a></li>\n                  </ul>\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div class="col-lg-10 col-sm-10 col-xs-12">\n\n          <div class="gmd panel panel-default">\n            <div class="panel-body">Informações</div>\n            <div class="panel-body">\n              <form>\n                <div class="row">\n                  <div class="col-sm-6">\n                    <div class="form-group">\n                      <label for="name">Nome</label>\n                      <input type="text" ng-model="$ctrl.user.name" class="gmd form-control" id="name" placeholder="Qual seu nome completo?">\n                    </div>\n                  </div>\n                  <div class="col-sm-6">\n                    <div class="form-group">\n                      <label for="email">E-mail</label>\n                      <input type="email" disabled="disabled" ng-model="$ctrl.user.login" class="gmd form-control" id="email" placeholder="Informe seu endereço de e-mail.">\n                    </div>\n                  </div>\n                </div>\n              </form>\n            </div>\n            <div class="panel-footer">\n              <button class="gmd btn btn-primary" ng-click="$ctrl.saveUser(\'Dados atualizado com sucesso.\')">Atualizar perfil</button>\n            </div>\n          </div>\n\n          <div class="gmd panel panel-default">\n            <div class="panel-body">Mudar senha</div>\n            <div class="panel-body">\n              <form>\n                <div class="row">\n                  <div class="col-sm-4">\n                    <div class="form-group">\n                      <label for="oldPassword">Senha antiga</label>\n                      <input type="password" ng-model="$ctrl.user.oldPassword" class="gmd form-control" id="oldPassword" placeholder="Qual sua senha atual?">\n                    </div>\n                  </div>\n                  <div class="col-sm-4">\n                    <div class="form-group">\n                      <label for="newPassword">Nova senha</label>\n                      <input type="password" ng-model="$ctrl.user.newPassword" class="gmd form-control" id="newPassword" placeholder="Escolha uma nova senha.">\n                    </div>\n                  </div>\n                  <div class="col-sm-4">\n                    <div class="form-group">\n                      <label for="confirmNewPassword">Confirme a nova senha</label>\n                      <input type="password" ng-model="$ctrl.user.confirmNewPassword" class="gmd form-control" id="confirmNewPassword" placeholder="Repita sua nova senha.">\n                    </div>\n                  </div>\n                </div>\n              </form>\n            </div>\n            <div class="panel-footer">\n              <button class="gmd btn btn-primary"\n                      ng-click="$ctrl.updatePassword($ctrl.user.oldPassword, $ctrl.user.newPassword, $ctrl.user.confirmNewPassword)">\n                      Atualizar senha\n              </button>\n            </div>\n          </div>\n\n      </div>\n    </div>\n\n  </div>\n</div>\n\n'}]);